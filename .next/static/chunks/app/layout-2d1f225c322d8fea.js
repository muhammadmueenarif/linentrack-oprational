(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{6647:function(){},1299:function(e,t,r){Promise.resolve().then(r.bind(r,6916))},2317:function(e,t,r){"use strict";r.d(t,{db:function(){return u}});var s=r(5236),a=r(9842),o=r(9930),n=r.n(o),i=r(5735),d=r(9854);n().config();let l=(0,s.ZF)({apiKey:"AIzaSyAFTMCP8Xess7YdQORSVoL-NGFDjPCnMHM",authDomain:"omebudgetapp-9f89b.firebaseapp.com",projectId:"homebudgetapp-9f89b",storageBucket:"homebudgetapp-9f89b.appspot.com",messagingSenderId:"376870799077",appId:"1:376870799077:web:63ec29e676a073f02f760c"}),u=(0,a.ad)(l);(0,i.v0)(l),(0,d.cF)(l)},6916:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return Y},dynamic:function(){return q}});var s=r(7437),a=r(4134),o=r.n(a);r(8877);var n=r(6862);let i="http://localhost:3005",d=(0,n.hg)("subscriber/fetchSubscribers",async()=>{let e=await fetch("".concat(i,"/api/clients"));if(!e.ok)throw Error("Failed to fetch subscribers");return e.json()}),l=(0,n.hg)("subscriber/updateSubscriberType",async e=>{let{userId:t,userType:r}=e;if(!(await fetch("".concat(i,"/api/clients/").concat(t,"/userType"),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer TOKEN"},body:JSON.stringify({userType:r})})).ok)throw Error("Failed to update subscriber type");return{userId:t,userType:r}}),u=(0,n.hg)("subscriber/fetchClientStatistics",async()=>{let e=await fetch("".concat(i,"/api/clients/statistics"));if(!e.ok)throw Error("Failed to fetch client statistics");return e.json()});var c=(0,n.oM)({name:"subscriber",initialState:{subscribers:[],loading:!1,error:null,statistics:null},reducers:{},extraReducers:e=>{e.addCase(d.pending,e=>{e.loading=!0,e.error=null}).addCase(d.fulfilled,(e,t)=>{e.loading=!1,e.subscribers=t.payload}).addCase(d.rejected,(e,t)=>{e.loading=!1,e.error=t.error.message}).addCase(l.pending,e=>{e.loading=!0,e.error=null}).addCase(l.fulfilled,(e,t)=>{e.loading=!1;let{userId:r,userType:s}=t.payload,a=e.subscribers.find(e=>e.userId===r);a&&(a.userType=s)}).addCase(l.rejected,(e,t)=>{e.loading=!1,e.error=t.error.message}).addCase(u.pending,e=>{e.loading=!0,e.error=null}).addCase(u.fulfilled,(e,t)=>{e.loading=!1,e.statistics=t.payload}).addCase(u.rejected,(e,t)=>{e.loading=!1,e.error=t.error.message})}}).reducer;let p={storeInfo:{companyName:"",streetAddress:"",zipCode:"",city:"",telephone:"",timezone:"",language:"",gpsCoordinates:{latitude:"",longitude:""}},servicesOffered:{pickupDelivery:!1,lockers:!1,inStoreOrders:!1,carOrders:!1,logo:{url:"",showOnEmail:!1,showOnNav:!1,showOnInvoice:!1}},tax:{salesTaxType:"",tax1:{name:"",rate:""},tax2:{name:"",rate:""},tax3:{name:"",rate:""},taxVatNumber:"",customIdForReports:""},security:{ipRestrictions:{enabled:!1,addresses:[]},pinSettings:{inactivityTimeout:0,required:!1},clockInSettings:{requireAdminClockIn:!1},twoFactorAuth:{enabled:!1,requiredForAdmin:!1},orderEditRestrictions:{enabled:!1,dateRange:{start:null,end:null}}},stores:[],groups:[],status:{storeInfo:"idle",servicesOffered:"idle",tax:"idle",security:"idle",stores:"idle",groups:"idle"},errors:{storeInfo:null,servicesOffered:null,tax:null,security:null,stores:null,groups:null},currentStore:null,currentGroup:null,lastUpdated:null},g=(0,n.hg)("storeSettings/fetchStoreSettings",async(e,t)=>{let{rejectWithValue:r}=t;try{let e=JSON.parse(localStorage.getItem("userData")),t=null==e?void 0:e.id;if(!t)throw Error("No admin ID found");let r=localStorage.getItem("selectedStoreId");if(!r)throw Error("No store selected");let s=await fetch("".concat(i,"/api/store-settings/").concat(t,"/").concat(r));if(!s.ok)throw Error("Failed to fetch store settings");return await s.json()}catch(e){return r(e.message)}}),f=(0,n.hg)("storeSettings/fetchAllStores",async(e,t)=>{let{rejectWithValue:r}=t;try{let e=JSON.parse(localStorage.getItem("userData")),t=null==e?void 0:e.id;if(!t)throw Error("No admin ID found");let r=await fetch("".concat(i,"/api/store-settings/stores/").concat(t));if(!r.ok)throw Error("Failed to fetch stores");return await r.json()}catch(e){return r(e.message)}}),h=(0,n.hg)("storeSettings/createStore",async(e,t)=>{let{storeData:r}=e,{rejectWithValue:s}=t;try{let e=JSON.parse(localStorage.getItem("userData")),t=null==e?void 0:e.id;if(!t)throw Error("No admin ID found");let s=await fetch("".concat(i,"/api/store-settings/stores/").concat(t),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!s.ok)throw Error("Failed to create store");return await s.json()}catch(e){return s(e.message)}}),m=(0,n.hg)("storeSettings/deleteStore",async(e,t)=>{let{storeId:r}=e,{rejectWithValue:s}=t;try{let e=JSON.parse(localStorage.getItem("userData")),t=null==e?void 0:e.id;if(!t)throw Error("No admin ID found");if(!(await fetch("".concat(i,"/api/store-settings/stores/").concat(t,"/").concat(r),{method:"DELETE"})).ok)throw Error("Failed to delete store");return r}catch(e){return s(e.message)}});(0,n.hg)("storeSettings/updateStoreSettings",async(e,t)=>{let{section:r,settings:s}=e,{rejectWithValue:a}=t;try{let e=JSON.parse(localStorage.getItem("userData")),t=null==e?void 0:e.id;if(!t)throw Error("No admin ID found");let a=localStorage.getItem("selectedStoreId");if(!a)throw Error("No store selected");let o=await fetch("".concat(i,"/api/store-settings/").concat(t,"/").concat(a),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({section:r,settings:s})});if(!o.ok)throw Error("Failed to update store settings");let n=await o.json();return{section:r,settings:n.settings||s}}catch(e){return a(e.message)}});let y=(0,n.oM)({name:"storeSettings",initialState:p,reducers:{setCurrentStore:(e,t)=>{var r;e.currentStore=t.payload,(null===(r=t.payload)||void 0===r?void 0:r.id)&&localStorage.setItem("selectedStoreId",t.payload.id)},setCurrentGroup:(e,t)=>{e.currentGroup=t.payload},addStore:(e,t)=>{e.stores.push({id:Date.now(),...t.payload})},updateStore:(e,t)=>{let r=e.stores.findIndex(e=>e.id===t.payload.id);-1!==r&&(e.stores[r]=t.payload)},removeStore:(e,t)=>{var r;e.stores=e.stores.filter(e=>e.id!==t.payload),(null===(r=e.currentStore)||void 0===r?void 0:r.id)===t.payload&&(e.currentStore=null)},addGroup:(e,t)=>{e.groups.push({id:Date.now(),...t.payload})},updateGroup:(e,t)=>{let r=e.groups.findIndex(e=>e.id===t.payload.id);-1!==r&&(e.groups[r]=t.payload)},removeGroup:(e,t)=>{var r;e.groups=e.groups.filter(e=>e.id!==t.payload),(null===(r=e.currentGroup)||void 0===r?void 0:r.id)===t.payload&&(e.currentGroup=null)},resetSection:(e,t)=>{let r=t.payload;e[r]=p[r],e.status[r]="idle",e.errors[r]=null},resetAll:()=>p,clearError:(e,t)=>{e.errors[t.payload]=null}},extraReducers:e=>{e.addCase(g.pending,e=>{Object.keys(e.status).forEach(t=>{e.status[t]="loading"})}).addCase(g.fulfilled,(e,t)=>{var r,s,a,o,n,i;let d=t.payload.settings||{};e.storeInfo={companyName:d.companyName||"",streetAddress:d.streetAddress||"",zipCode:d.zipCode||"",city:d.city||"",telephone:d.telephone||"",timezone:d.timezone||"",language:d.language||"",gpsCoordinates:{latitude:(null===(r=d.gpsCoordinates)||void 0===r?void 0:r.latitude)||"",longitude:(null===(s=d.gpsCoordinates)||void 0===s?void 0:s.longitude)||""}},e.servicesOffered={pickupDelivery:d.pickupDelivery||!1,lockers:d.lockers||!1,inStoreOrders:d.inStoreOrders||!1,carOrders:d.carOrders||!1,logo:{url:(null===(a=d.logo)||void 0===a?void 0:a.url)||"",showOnEmail:(null===(o=d.logo)||void 0===o?void 0:o.showOnEmail)||!1,showOnNav:(null===(n=d.logo)||void 0===n?void 0:n.showOnNav)||!1,showOnInvoice:(null===(i=d.logo)||void 0===i?void 0:i.showOnInvoice)||!1}},e.tax={salesTaxType:d.salesTaxType||"",tax1:d.tax1||{name:"",rate:""},tax2:d.tax2||{name:"",rate:""},tax3:d.tax3||{name:"",rate:""},taxVatNumber:d.taxVatNumber||"",customIdForReports:d.customIdForReports||""},e.security={ipRestrictions:d.ipRestrictions||p.security.ipRestrictions,pinSettings:d.pinSettings||p.security.pinSettings,clockInSettings:d.clockInSettings||p.security.clockInSettings,twoFactorAuth:d.twoFactorAuth||p.security.twoFactorAuth,orderEditRestrictions:d.orderEditRestrictions||p.security.orderEditRestrictions},Array.isArray(d.stores)&&(e.stores=d.stores.map(e=>({id:e.id,name:e.name||"",address:e.address||"",city:e.city||"",zipCode:e.zipCode||"",plan:e.plan||"Standard",period:e.period||"M",country:e.country||"",phoneNumber:e.phoneNumber||""}))),Array.isArray(d.groups)&&(e.groups=d.groups.map(e=>({id:e.id,name:e.name||"",description:e.description||"",stores:e.stores||"",tier:e.tier||"Basic"}))),Object.keys(e.status).forEach(t=>{e.status[t]="succeeded",e.errors[t]=null}),e.lastUpdated=new Date().toISOString()}).addCase(g.rejected,(e,t)=>{Object.keys(e.status).forEach(r=>{e.status[r]="failed",e.errors[r]=t.payload})}).addCase(f.pending,e=>{e.status.stores="loading"}).addCase(f.fulfilled,(e,t)=>{e.stores=t.payload,e.status.stores="succeeded",e.errors.stores=null}).addCase(f.rejected,(e,t)=>{e.status.stores="failed",e.errors.stores=t.payload}).addCase(h.pending,e=>{e.status.stores="loading"}).addCase(h.fulfilled,(e,t)=>{e.stores.push(t.payload),e.status.stores="succeeded",e.errors.stores=null}).addCase(h.rejected,(e,t)=>{e.status.stores="failed",e.errors.stores=t.payload}).addCase(m.pending,e=>{e.status.stores="loading"}).addCase(m.fulfilled,(e,t)=>{var r;e.stores=e.stores.filter(e=>e.id!==t.payload),(null===(r=e.currentStore)||void 0===r?void 0:r.id)===t.payload&&(e.currentStore=null,localStorage.removeItem("selectedStoreId")),e.status.stores="succeeded",e.errors.stores=null}).addCase(m.rejected,(e,t)=>{e.status.stores="failed",e.errors.stores=t.payload})}}),{setCurrentStore:S,setCurrentGroup:v,addStore:b,updateStore:w,removeStore:C,addGroup:I,updateGroup:O,removeGroup:E,resetSection:x,resetAll:N,clearError:j}=y.actions;var k=y.reducer,D=r(2317),A=r(9842);let T=(0,n.hg)("storeUsers/fetchStoreUsers",async(e,t)=>{let{rejectWithValue:r}=t;try{let t=(0,A.hJ)(D.db,"StoreUsers"),r=(0,A.JU)(t,e),s=(0,A.hJ)(r,"users"),a=await (0,A.PL)(s),o=[];return a.forEach(e=>{o.push({id:e.id,...e.data()})}),o}catch(e){return r(e.message)}}),F=(0,n.hg)("storeUsers/uploadStoreUsers",async(e,t)=>{let{adminId:r,users:s}=e,{rejectWithValue:a}=t;try{let e=(0,A.hJ)(D.db,"StoreUsers"),t=(0,A.JU)(e,r),a=(0,A.hJ)(t,"users"),o=(0,A.qs)(D.db);return s.forEach(e=>{let t=(0,A.JU)(a);o.set(t,{...e,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()})}),await o.commit(),{usersCount:s.length}}catch(e){return a(e.message)}}),J=(0,n.oM)({name:"storeUsers",initialState:{users:[],status:"idle",error:null,uploadStatus:"idle",uploadError:null,lastUpdated:null},reducers:{resetUploadStatus:e=>{e.uploadStatus="idle",e.uploadError=null},clearError:e=>{e.error=null,e.uploadError=null}},extraReducers:e=>{e.addCase(T.pending,e=>{e.status="loading"}).addCase(T.fulfilled,(e,t)=>{e.status="succeeded",e.users=t.payload,e.lastUpdated=new Date().toISOString()}).addCase(T.rejected,(e,t)=>{e.status="failed",e.error=t.payload}).addCase(F.pending,e=>{e.uploadStatus="uploading",e.uploadError=null}).addCase(F.fulfilled,e=>{e.uploadStatus="succeeded",e.lastUpdated=new Date().toISOString()}).addCase(F.rejected,(e,t)=>{e.uploadStatus="failed",e.uploadError=t.payload})}}),{resetUploadStatus:R,clearError:U}=J.actions;var z=J.reducer;let L=(0,n.xC)({reducer:{subscriber:c,storeSettings:k,storeUsers:z}});var M=r(1444),G=r(2265),P=r(6463),B=()=>((0,G.useEffect)(()=>{let e=document.createElement("style");return e.textContent="\n      @keyframes dotBounce {\n        0%, 80%, 100% { \n          transform: translateY(0);\n        }\n        40% { \n          transform: translateY(-12px);\n        }\n      }\n      \n      .animate-dot1 {\n        animation: dotBounce 1.4s ease-in-out 0s infinite;\n      }\n      \n      .animate-dot2 {\n        animation: dotBounce 1.4s ease-in-out 0.2s infinite;\n      }\n      \n      .animate-dot3 {\n        animation: dotBounce 1.4s ease-in-out 0.4s infinite;\n      }\n    ",document.head.appendChild(e),()=>{document.head.removeChild(e)}},[]),(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)("div",{className:"w-4 h-4 bg-blue-500 rounded-full animate-dot1"}),(0,s.jsx)("div",{className:"w-4 h-4 bg-blue-500 rounded-full animate-dot2"}),(0,s.jsx)("div",{className:"w-4 h-4 bg-blue-500 rounded-full animate-dot3"})]})})),_=r(3580);r(4193);let q="force-dynamic",V=["/Login"];function H(e){let{children:t}=e,r=(0,P.useRouter)(),a=(0,P.usePathname)(),[o,n]=(0,G.useState)(!0);return((0,G.useEffect)(()=>{(()=>{let e=localStorage.getItem("token"),t=localStorage.getItem("userData");if(e&&t&&"/Login"===a){try{let e=JSON.parse(t);"Staff"===e.roleType&&("operations"===e.accessMode||"operation"===e.accessMode)?r.push("/"):r.push("/Login")}catch(e){console.error("Error parsing userData on redirect:",e),r.push("/Login")}return}if(a.startsWith("/SuperAdmin")||V.includes(a)){n(!1);return}if(!e||!t){r.push("/Login");return}try{let e=JSON.parse(t);"Staff"===e.roleType&&("operations"===e.accessMode||"operation"===e.accessMode)?n(!1):r.push("/Login")}catch(e){r.push("/Login")}})()},[a,r]),o)?(0,s.jsx)(B,{}):t}function Y(e){let{children:t}=e;return(0,s.jsx)("html",{lang:"en",children:(0,s.jsx)(M.zt,{store:L,children:(0,s.jsxs)("body",{className:"".concat(o().variable," font-poppins"),children:[(0,s.jsx)(H,{children:t}),(0,s.jsx)(_.Ix,{position:"top-right",autoClose:3e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"light"})]})})})}},8877:function(){}},function(e){e.O(0,[415,404,358,657,218,109,580,466,971,23,744],function(){return e(e.s=1299)}),_N_E=e.O()}]);