"use strict";exports.id=610,exports.ids=[610],exports.modules={9318:(e,t,r)=>{r.d(t,{Z:()=>v});var s=r(326),a=r(7577),i=r.n(a),o=r(622),n=r(5047),l=r(434),d=r(7147),c=r(76);let u={newOrder:"permNewOrder",pickupDeliveries:"permPickupDeliveries",cleaning:"permCleaning",ironingFolding:"permIroningFolding",ready:"permReady",details:"permDetails",machine:"permMachine"};function h(){try{return null}catch{return null}}async function m(){let e=h();if(!e)return{};if("Admin"===e.roleType)return{__admin:!0};try{e.id}catch{}try{let t=e.id;if(!t)return{};let r=(0,c.JU)(d.db,"storeStaff",t),s=await (0,c.QT)(r);return(s.exists()?s.data():{}).permissions||{}}catch{return{}}}async function x(e){let t=h();if(!t)return!1;if("Admin"===t.roleType)return!0;let r=await m();return!!r.__admin||!!r[e]}var p=r(89);let f=(0,a.createContext)(),g=()=>(0,a.useContext)(f),w=()=>(0,s.jsxs)("svg",{width:"11.42",height:"10.61",viewBox:"0 0 11.42 10.61",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[s.jsx("path",{d:"M0 5.30542H11.42",stroke:"#1D68F4",strokeWidth:"1.53696"}),s.jsx("path",{d:"M6.07544 0.694697L10.7932 5.30542L6.07544 9.91614",stroke:"#1D68F4",strokeWidth:"1.53696",strokeLinecap:"round",strokeLinejoin:"round"})]}),b={search:()=>(0,s.jsxs)("svg",{className:"w-5 h-5 text-gray-900",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[s.jsx("path",{d:"M11 19C15.4183 19 19 15.4183 19 11C19 6.58172 15.4183 3 11 3C6.58172 3 3 6.58172 3 11C3 15.4183 6.58172 19 11 19Z",stroke:"#2A2E34",strokeWidth:"1.53696",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M16.6569 16.6569L20.5 20.5",stroke:"#2A2E34",strokeWidth:"1.53696",strokeLinecap:"round",strokeLinejoin:"round"})]}),"file-text":()=>(0,s.jsxs)("svg",{className:"w-5 h-5 text-gray-900",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[s.jsx("path",{d:"M14 2H6C5.46957 2 4.96086 2.21071 4.58579 2.58579C4.21071 2.96086 4 3.46957 4 4V20C4 20.5304 4.21071 21.0391 4.58579 21.4142C4.96086 21.7893 5.46957 22 6 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V8L14 2Z",stroke:"#2A2E34",strokeWidth:"1.53696",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M14 2V8H20",stroke:"#2A2E34",strokeWidth:"1.53696",strokeLinecap:"round",strokeLinejoin:"round"})]}),"bar-chart":()=>(0,s.jsxs)("svg",{className:"w-5 h-5 text-gray-900",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[s.jsx("path",{d:"M12 21C16.9706 21 21 16.9706 21 12C21 7.02944 16.9706 3 12 3C7.02944 3 3 7.02944 3 12C3 16.9706 7.02944 21 12 21Z",stroke:"#2A2E34",strokeWidth:"1.53696",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M12 3V12H21",stroke:"#2A2E34",strokeWidth:"1.53696",strokeLinecap:"round",strokeLinejoin:"round"})]}),box:()=>(0,s.jsxs)("svg",{className:"w-5 h-5 text-gray-900",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[s.jsx("path",{d:"M12 4L20 8L12 12L4 8L12 4Z",stroke:"#2A2E34",strokeWidth:"1.53696",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M14 6L18 8",stroke:"#2A2E34",strokeWidth:"1.53696",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M10 6L6 8",stroke:"#2A2E34",strokeWidth:"1.53696",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M4 8L4 16",stroke:"#2A2E34",strokeWidth:"1.53696",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M20 8L20 16",stroke:"#2A2E34",strokeWidth:"1.53696",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M4 16L12 20L20 16",stroke:"#2A2E34",strokeWidth:"1.53696",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M12 12V20",stroke:"#2A2E34",strokeWidth:"1.53696",strokeLinecap:"round",strokeLinejoin:"round"})]}),"hard-drive":()=>(0,s.jsxs)("svg",{className:"w-5 h-5 text-gray-900",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[s.jsx("rect",{x:"3",y:"10",width:"18",height:"8",rx:"2",stroke:"#2A2E34",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M5 18H19V22H5V18Z",stroke:"#2A2E34",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("rect",{x:"7",y:"6",width:"10",height:"4",rx:"1",stroke:"#2A2E34",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),users:()=>(0,s.jsxs)("svg",{className:"w-5 h-5 text-gray-900",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[s.jsx("path",{d:"M12 11C14.2091 11 16 9.20914 16 7C16 4.79086 14.2091 3 12 3C9.79086 3 8 4.79086 8 7C8 9.20914 9.79086 11 12 11Z",stroke:"#2A2E34",strokeWidth:"1.53696",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M19 21V19C19 16.7909 17.2091 15 15 15H9C6.79086 15 5 16.7909 5 19V21",stroke:"#2A2E34",strokeWidth:"1.53696",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M16 7C16 4.79086 17.7909 3 20 3C22.2091 3 24 4.79086 24 7",stroke:"#2A2E34",strokeWidth:"1.53696",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M19 15C21.2091 15 23 16.7909 23 19V21",stroke:"#2A2E34",strokeWidth:"1.53696",strokeLinecap:"round",strokeLinejoin:"round"})]}),"trending-up":()=>(0,s.jsxs)("svg",{className:"w-5 h-5 text-gray-900",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[s.jsx("path",{d:"M12 21.0001C16.9706 21.0001 21 16.9706 21 12.0001C21 7.02951 16.9706 3.00006 12 3.00006C7.02944 3.00006 3 7.02951 3 12.0001C3 16.9706 7.02944 21.0001 12 21.0001Z",stroke:"#2A2E34",strokeWidth:"1.53696",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M12 16.5001C14.4853 16.5001 16.5 14.4853 16.5 12.0001C16.5 9.51486 14.4853 7.50006 12 7.50006C9.51472 7.50006 7.5 9.51486 7.5 12.0001C7.5 14.4853 9.51472 16.5001 12 16.5001Z",stroke:"#2A2E34",strokeWidth:"1.53696",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M12 12.0001V12.0001",stroke:"#2A2E34",strokeWidth:"1.53696",strokeLinecap:"round",strokeLinejoin:"round"})]}),settings:()=>(0,s.jsxs)("svg",{className:"w-5 h-5 text-gray-900",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[s.jsx("path",{d:"M12 11C14.2091 11 16 9.20914 16 7C16 4.79086 14.2091 3 12 3C9.79086 3 8 4.79086 8 7C8 9.20914 9.79086 11 12 11Z",stroke:"#2A2E34",strokeWidth:"1.53696",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M19 21V19C19 16.7909 17.2091 15 15 15H9C6.79086 15 5 16.7909 5 19V21",stroke:"#2A2E34",strokeWidth:"1.53696",strokeLinecap:"round",strokeLinejoin:"round"})]})},k=({item:e,pathname:t})=>{let[r,a]=i().useState(!0);return i().useEffect(()=>{(async()=>{a(await x(e.permKey))})()},[e.permKey]),s.jsx("li",{className:"relative",children:r?s.jsx(l.default,{href:e.path,className:`cursor-pointer hover:text-yellow-500 transition-colors duration-200 ${t===e.path?"text-yellow-500 font-bold":"text-white"} inline-block`,style:{fontFamily:"Poppins, sans-serif",fontWeight:500,fontSize:"14.0625px",lineHeight:"21px"},children:e.name}):(0,s.jsxs)("div",{className:"flex items-center text-gray-400 cursor-not-allowed",children:[e.name,s.jsx(o.kUi,{className:"ml-1 text-xs"}),s.jsx("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 bg-gray-800 text-white text-xs rounded opacity-0 hover:opacity-100 transition-opacity whitespace-nowrap",children:"You do not have permission"})]})})},y=({subscriptionData:e})=>{let t=(0,n.usePathname)(),r=e?.features?e?.features:JSON.parse(localStorage.getItem("subscriptionData"))?.features,a=[{name:"New Order",path:"/Admin",feature:"Order per month",permKey:u.newOrder},...r&&!1===r.pickupDelivery?[]:[{name:"Pickup & Deliveries",path:"/Admin/Delivery",feature:"Pickup & Delivery",permKey:u.pickupDeliveries}],{name:"Cleaning",path:"/Admin/Cleaning",feature:"Order per month",permKey:u.cleaning},{name:"Ironing & Folding",path:"/Admin/Ironing",feature:"Ironing & Folding",permKey:u.ironingFolding},{name:"Ready",path:"/Admin/Ready",feature:"Ready",permKey:u.ready},{name:"Details",path:"/Admin/Detailed",feature:"Details",permKey:u.details},{name:"Machine",path:"/Admin/Machine",feature:"Machine",permKey:u.machine}];return s.jsx("div",{className:"flex flex-1 justify-center",children:s.jsx("ul",{className:"flex whitespace-nowrap gap-5",children:a.map(e=>s.jsx(k,{item:e,pathname:t},e.path))})})},j=({subscriptionData:e})=>{let t=(0,n.useRouter)();e?.features;let r=e=>{e.path&&t.push(e.path)};return s.jsx("div",{className:"grid grid-cols-2 gap-1 p-6",children:[{name:"Search",description:"Find An item",icon:"search",feature:"Order per month",path:"/Admin/NavMenu/Search"},{name:"Hardware",description:"Get invoices",icon:"hard-drive",feature:"Hardware Integration",path:"/Admin/NavMenu/Hardware"},{name:"Invoice",description:"Impactful storytelling",icon:"file-text",feature:"Auto Invoicing",path:"/Admin/NavMenu/Invoice"},{name:"Users",description:"Functional digital products",icon:"users",feature:"Admin Tools",path:"/Admin/NavMenu/Users"},{name:"Metrix",description:"Beautiful crafted prints",icon:"bar-chart",feature:"Order per month",path:"/Admin/NavMenu/Dashboard"},{name:"Marketing",description:"Beautiful crafted prints",icon:"trending-up",feature:"Marketing",path:"/Admin/NavMenu/Marketing"},{name:"Products",description:"Artistic visual expression",icon:"box",feature:"Order per month",path:"/Admin/NavMenu/Products"},{name:"Admin",description:"Artistic visual expression",icon:"settings",feature:"Admin Tools",path:"/Admin/NavMenu/Dashboard"}].map((e,t)=>{let a=b[e.icon];return(0,s.jsxs)("div",{className:"flex items-center p-2 rounded-lg hover:bg-gray-50 transition-colors duration-150 cursor-pointer",onClick:()=>r(e),role:"button",tabIndex:0,"aria-disabled":!1,children:[s.jsx("div",{className:"flex items-center justify-center mr-3",children:a?s.jsx(a,{}):null}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.name}),!1]}),s.jsx("div",{className:"text-xs text-gray-500",children:e.description})]}),s.jsx(w,{})]},t)})})},v=({subscriptionData:e})=>{let[t,r]=(0,a.useState)(!1),[i,u]=(0,a.useState)(!1),[h,m]=(0,a.useState)(!1),[x,f]=(0,a.useState)(!1),[w,b]=(0,a.useState)(null),[k,v]=(0,a.useState)(null),[S,N]=(0,a.useState)(0),[C,I]=(0,a.useState)({amount:"",description:"",notes:"",selectedUserId:"",declaredCash:"",cashFromOrders:"",startingCash:""}),L=()=>{I({amount:"",description:"",notes:"",selectedUserId:F.length>0?F[0].id:"",declaredCash:"",cashFromOrders:"",startingCash:""})},[F,A]=(0,a.useState)([]),[O,M]=(0,a.useState)(!1),[E,D]=(0,a.useState)({requireStartingCash:!1,trackDrawerPayouts:!1}),[U,W]=(0,a.useState)(null),[T,H]=(0,a.useState)(""),[P,B]=(0,a.useState)(""),[J,V]=(0,a.useState)(!1),[z,q]=(0,a.useState)(!1),[Z,K]=(0,a.useState)(""),[$,R]=(0,a.useState)(""),[Q,G]=(0,a.useState)(""),[X,_]=(0,a.useState)("");(0,a.useRef)([]);let Y=(0,n.useRouter)(),ee=g(),et=(0,a.useRef)(null),er=(0,a.useRef)(null);(0,a.useEffect)(()=>{let e=JSON.parse(localStorage.getItem("userData")),t=localStorage.getItem("selectedStoreId");e&&b(e),t&&v(t);let s=e=>{et.current&&!et.current.contains(e.target)&&r(!1),er.current&&!er.current.contains(e.target)&&u(!1)};return document.addEventListener("mousedown",s),()=>{document.removeEventListener("mousedown",s),r(!1),u(!1),m(!1),f(!1)}},[]),(0,a.useEffect)(()=>{if(!k)return;let e=(0,c.hJ)(d.db,"notifications"),t=(0,c.IO)(e,(0,c.ar)("storeId","==",k),(0,c.ar)("status","==",p.i.Pending)),r=(0,c.cf)(t,e=>{N(e.size)},e=>{console.error("Error fetching notification count:",e)});return()=>r()},[k]),(0,a.useEffect)(()=>{if(!k||!w?.id)return;let e=new Date().toLocaleDateString("en-GB"),t=(0,c.hJ)(d.db,"staffShifts"),r=(0,c.IO)(t,(0,c.ar)("storeId","==",k),(0,c.ar)("userId","==",w.id),(0,c.ar)("date","==",e),(0,c.Xo)("createdAt","desc"),(0,c.b9)(1)),s=(0,c.cf)(r,e=>{if(e.empty){W(null),H(""),B("");return}let t=e.docs[0],r=t.data();W({id:t.id,...r}),H(r.clockIn||""),B(r.clockOut||"")});return()=>s()},[k,w?.id]);let es=e=>new Intl.DateTimeFormat("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0}).format(e),ea=e=>e.toLocaleDateString("en-GB"),ei=async()=>{try{if(!k||!w?.id)return;if(U&&!U.clockOut){G("You already have an active shift"),setTimeout(()=>G(""),2500);return}let e=new Date,t=e.getHours();if(!Z||!Z.trim()){let e=6,r=22;try{let t=(0,c.JU)(d.db,"storeSettings",k),s=await (0,c.QT)(t);if(s.exists()){let t=s.data();e=t?.security?.clockInSettings?.shiftStartHour??6,r=t?.security?.clockInSettings?.shiftEndHour??22}}catch(e){console.warn("Could not fetch shift hours settings",e)}if(t<e||t>=r){G(`Cannot clock in outside shift hours (${e}:00 - ${r}:00)`),setTimeout(()=>G(""),2500);return}}let r=Z&&Z.trim()?Z.trim():es(e),s=en(e,Z),a={storeId:k,storeName:localStorage.getItem("selectedStore")||"",userId:w.id,name:w.name||w.email||"Staff",date:ea(e),clockIn:r,clockOut:"",clockInISO:s,clockOutISO:"",createdAt:(0,c.Bt)()};await (0,c.ET)((0,c.hJ)(d.db,"staffShifts"),a);try{await (0,c.ET)((0,c.hJ)(d.db,"shifts"),a)}catch(e){console.warn("Failed to save to shifts collection",e)}V(!1),K(""),H(r),console.log("Time In saved:",r),G("Time in Successfully Added"),setTimeout(()=>G(""),2500)}catch(e){console.error("Time In failed",e)}},eo=async()=>{try{if(!k||!w?.id||!U||U.clockOut)return;if(!$||!$.trim()){let e=6,t=22;try{let r=(0,c.JU)(d.db,"storeSettings",k),s=await (0,c.QT)(r);if(s.exists()){let r=s.data();e=r?.security?.clockInSettings?.shiftStartHour??6,t=r?.security?.clockInSettings?.shiftEndHour??22}}catch(e){console.warn("Could not fetch shift hours settings",e)}let r=new Date().getHours();if(r<e||r>=t){G(`Cannot clock out outside shift hours (${e}:00 - ${t}:00)`),setTimeout(()=>G(""),2500);return}}let e=new Date,t=$&&$.trim()?$.trim():es(e),r=en(e,$),s=U.clockInISO?Math.max(0,(new Date(r)-new Date(U.clockInISO))/36e5):0;try{let e=(0,c.JU)(d.db,"payrollSettings",k),t=await (0,c.QT)(e),r=16;if(t.exists()){let e=t.data();r=e?.maxHoursPerShift??16}let a=r,i=Math.max(0,(Number(r)||0)+(Number(a)||0));i&&s>i&&(s=i)}catch(e){console.warn("Overtime cap read failed",e)}await (0,c.r7)((0,c.JU)(d.db,"staffShifts",U.id),{clockOut:t,clockOutISO:r,hours:s.toFixed(2)});try{let a=(0,c.hJ)(d.db,"shifts"),i=ea(e),o=(0,c.IO)(a,(0,c.ar)("storeId","==",k),(0,c.ar)("userId","==",w.id),(0,c.ar)("date","==",i),(0,c.Xo)("createdAt","desc"),(0,c.b9)(1)),n=await (0,c.PL)(o);if(!n.empty){let e=n.docs[0];await (0,c.r7)(e.ref,{clockOut:t,clockOutISO:r,hours:s.toFixed(2)})}}catch(e){console.warn("Failed to update shifts collection",e)}q(!1),R(""),B(t),console.log("Time Out saved:",t),G("Time out Successfully Added"),setTimeout(()=>G(""),2500)}catch(e){console.error("Time Out failed",e)}},en=(e,t)=>{if(!t)return e.toISOString();try{let r=t.trim().match(/^(\d{1,2}):(\d{2})\s*(AM|PM)$/i);if(!r)return e.toISOString();let s=parseInt(r[1],10),a=parseInt(r[2],10),i=r[3].toUpperCase();"PM"===i&&12!==s&&(s+=12),"AM"===i&&12===s&&(s=0);let o=new Date(e);return o.setHours(s,a,0,0),o.toISOString()}catch{return e.toISOString()}};(0,a.useEffect)(()=>{if(!k)return;let e=(0,c.hJ)(d.db,"storeStaff"),t=(0,c.IO)(e,(0,c.ar)("storeId","==",k)),r=(0,c.cf)(t,e=>{let t=e.docs.map(e=>({id:e.id,...e.data()}));A(t),t.length>0&&!C.selectedUserId&&I(e=>({...e,selectedUserId:t[0].id}))},e=>{console.error("Error loading staff users for cash up:",e)});return()=>r()},[k,C.selectedUserId]),(0,a.useEffect)(()=>{(async()=>{try{if(!k)return;let e=(0,c.JU)(d.db,"storeSettings",k),t=await (0,c.QT)(e);if(t.exists()){let e=t.data();D(e.cashUp||{requireStartingCash:!1,trackDrawerPayouts:!1})}}catch(e){console.error("Error loading cash up settings:",e)}})()},[k]);let el=async()=>{try{if(w?.roleType==="Staff"&&U&&!U.clockOut)try{let e=new Date,t=es(e),r=e.toISOString(),s=U.clockInISO?Math.max(0,(e-new Date(U.clockInISO))/36e5):0;try{let e=(0,c.JU)(d.db,"payrollSettings",k),t=await (0,c.QT)(e),r=16;if(t.exists()){let e=t.data();r=e?.maxHoursPerShift??16}let a=r,i=Math.max(0,(Number(r)||0)+(Number(a)||0));i&&s>i&&(s=i)}catch(e){console.warn("Overtime cap read failed during logout",e)}await (0,c.r7)((0,c.JU)(d.db,"staffShifts",U.id),{clockOut:t,clockOutISO:r,hours:s.toFixed(2)});try{let a=(0,c.hJ)(d.db,"shifts"),i=ea(e),o=(0,c.IO)(a,(0,c.ar)("storeId","==",k),(0,c.ar)("userId","==",w.id),(0,c.ar)("date","==",i),(0,c.Xo)("createdAt","desc"),(0,c.b9)(1)),n=await (0,c.PL)(o);if(!n.empty){let e=n.docs[0];await (0,c.r7)(e.ref,{clockOut:t,clockOutISO:r,hours:s.toFixed(2)})}}catch(e){console.warn("Failed to update shifts collection during logout",e)}console.info("[Logout] Auto time-out completed for staff",{userId:w.id,hoursWorked:s.toFixed(2)})}catch(e){console.warn("[Logout] Auto time-out failed",e)}localStorage.removeItem("userData"),localStorage.removeItem("token"),localStorage.removeItem("selectedStoreId"),localStorage.removeItem("selectedStoredata"),window.location.href="/login"}catch(e){console.error("[Logout] Error during logout process",e),localStorage.removeItem("userData"),localStorage.removeItem("token"),localStorage.removeItem("selectedStoreId"),localStorage.removeItem("selectedStoredata"),window.location.href="/login"}},ed=async()=>{try{if(!k||!w?.id)throw Error("Store or user information missing");let e=["amount","selectedUserId","declaredCash"];for(let t of(E.requireStartingCash&&!C.startingCash&&e.push("startingCash"),e))if(!C[t])throw Error(`Please fill in all required fields: ${t.replace(/([A-Z])/g," $1").toLowerCase()}`);let t=F.find(e=>e.id===C.selectedUserId);await (0,c.ET)((0,c.hJ)(d.db,"cashups"),{amount:parseFloat(C.amount),declaredCash:parseFloat(C.declaredCash),cashFromOrders:parseFloat(C.cashFromOrders||0),confirmedCash:parseFloat(C.declaredCash),staff:t?.name||t?.email||"Unknown",startingCash:parseFloat(C.startingCash||0),description:C.description,notes:C.notes,storeId:k,userId:C.selectedUserId,createdBy:w.id,createdAt:(0,c.Bt)(),status:"pending",variance:0,settings:E}),L(),m(!1),alert("Cash up recorded successfully!")}catch(e){console.error("Error saving cash up:",e),alert("Failed to save cash up: "+e.message)}},ec=e=>{let{name:t,value:r}=e.target;I(e=>({...e,[t]:r}))},eu=async()=>{try{if(f(!1),w?.roleType==="Staff"&&U&&!U.clockOut)try{let e=new Date,t=es(e),r=e.toISOString(),s=U.clockInISO?Math.max(0,(e-new Date(U.clockInISO))/36e5):0;try{let e=(0,c.JU)(d.db,"payrollSettings",k),t=await (0,c.QT)(e),r=16;if(t.exists()){let e=t.data();r=e?.maxHoursPerShift??16}let a=r,i=Math.max(0,(Number(r)||0)+(Number(a)||0));i&&s>i&&(s=i)}catch(e){console.warn("Overtime cap read failed during switch user",e)}await (0,c.r7)((0,c.JU)(d.db,"staffShifts",U.id),{clockOut:t,clockOutISO:r,hours:s.toFixed(2)});try{let a=(0,c.hJ)(d.db,"shifts"),i=ea(e),o=(0,c.IO)(a,(0,c.ar)("storeId","==",k),(0,c.ar)("userId","==",w.id),(0,c.ar)("date","==",i),(0,c.Xo)("createdAt","desc"),(0,c.b9)(1)),n=await (0,c.PL)(o);if(!n.empty){let e=n.docs[0];await (0,c.r7)(e.ref,{clockOut:t,clockOutISO:r,hours:s.toFixed(2)})}}catch(e){console.warn("Failed to update shifts collection during switch user",e)}console.info("[Switch User] Auto time-out completed for staff",{userId:w.id,hoursWorked:s.toFixed(2)})}catch(e){console.warn("[Switch User] Auto time-out failed",e)}setTimeout(()=>{localStorage.removeItem("userData"),localStorage.removeItem("selectedStoreId"),localStorage.removeItem("selectedStoredata"),window.location.href="/Login"},100)}catch(e){console.error("[Switch User] Error during switch user process",e),setTimeout(()=>{localStorage.removeItem("userData"),localStorage.removeItem("selectedStoreId"),localStorage.removeItem("selectedStoredata"),window.location.href="/Login"},100)}};return(0,s.jsxs)("nav",{style:{position:"fixed",top:"0px",left:"0px",right:"0px",width:"100%",zIndex:"50",backgroundColor:"#1D50B6",opacity:"1",margin:0,padding:"8px 16px",boxSizing:"border-box"},className:"flex items-center text-white",children:[Q&&s.jsx("div",{className:"fixed top-[64px] left-1/2 -translate-x-1/2 z-[60]",children:s.jsx("div",{className:"px-4 py-2 rounded-md bg-green-100 text-green-800 border border-green-200 text-sm shadow-sm",children:Q})}),s.jsx("div",{className:"flex items-center space-x-3 flex-1",style:{marginLeft:"3.06%"},children:(0,s.jsxs)("div",{ref:et,className:"relative flex items-center",children:[s.jsx("img",{src:"/navbar/humbar.svg",alt:"Menu",className:"cursor-pointer",style:{width:"24px",height:"24px"},onClick:()=>r(!t)}),"/Admin"===(0,n.usePathname)()&&s.jsx("span",{className:"ml-3 font-bold",style:{fontSize:"18px",lineHeight:"22px"},children:"Admin"}),t&&(0,s.jsxs)("div",{className:"absolute left-0 w-[400px] bg-white rounded-lg shadow-lg overflow-hidden",style:{zIndex:10,top:"40px"},children:[s.jsx("div",{className:"custom-notch"}),s.jsx(j,{subscriptionData:e})]})]})}),s.jsx("div",{className:"flex-1 flex justify-center",children:s.jsx(y,{subscriptionData:e})}),(0,s.jsxs)("div",{className:"flex items-center space-x-4 flex-1 justify-end",children:[(0,s.jsxs)("div",{className:"relative",children:[s.jsx("img",{src:"/navbar/bell.svg",alt:"Notifications",className:"cursor-pointer",style:{width:"24px",height:"24px"},onClick:()=>Y.push("/Admin/Notifications")}),S>0&&s.jsx("span",{className:"bg-yellow-500 text-black font-bold px-1 text-xs rounded-full absolute -top-2 -right-2",children:S>9?"9+":S})]}),s.jsx("div",{className:"relative",children:s.jsx(l.default,{href:"Admin/Chat",children:s.jsx("img",{src:"/navbar/chat.svg",alt:"Chat",className:"cursor-pointer hover:opacity-90",style:{width:"24px",height:"24px"}})})}),(0,s.jsxs)("div",{ref:er,className:"relative",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3 cursor-pointer",onClick:()=>u(!i),children:[s.jsx("div",{className:"h-8 border-l border-white/30"}),(0,s.jsxs)("div",{className:"text-right",children:[s.jsx("div",{style:{fontFamily:"Poppins, sans-serif",fontWeight:700,fontSize:"18px",lineHeight:"27px",color:"#FFFFFF"},children:w?.name||"Guest"}),s.jsx("div",{style:{fontFamily:"Poppins, sans-serif",fontWeight:400,fontSize:"12px",lineHeight:"18px",color:"#E1E1E1"},children:w?.email||`@${(w?.username||(w?.email?w.email.split("@")[0]:"guest")).toLowerCase()}`})]}),(()=>{try{let e=JSON.parse(localStorage.getItem("selectedStoredata"))||{},t=e?.servicesOffered?.logo?.url;if(t&&e?.servicesOffered?.logo?.showOnNav)return s.jsx("img",{src:t,alt:"profile",className:"w-10 h-10 rounded-full object-contain bg-white"})}catch{}return s.jsx("img",{src:"https://placehold.co/40x40/png",alt:"profile",className:"w-10 h-10 rounded-full"})})(),s.jsx(o.qL$,{className:"text-white text-sm"})]}),i&&s.jsx("div",{className:"absolute right-0 mt-2 w-80 bg-white rounded-lg shadow-xl overflow-hidden",style:{zIndex:2,maxWidth:"calc(100vw - 2rem)",minWidth:"280px"},children:(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-800",children:w?.name||"Guest"}),s.jsx("button",{className:"bg-[#F0F0FF] text-red-600 p-1 px-3 rounded-full text-sm",onClick:()=>f(!0),children:"Switch User"})]}),ee?.isClockStopped&&s.jsx("div",{className:"flex items-center justify-center py-2 bg-red-50 border border-red-200 rounded-lg mb-2",children:(0,s.jsxs)("div",{className:"flex items-center gap-2 text-red-600 text-sm",children:[s.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse"}),s.jsx("span",{className:"text-xs font-medium",children:"Clock Stopped - Enter PIN to Continue"})]})}),w?.roleType==="Staff"&&s.jsx("div",{className:"flex items-center justify-center py-2 bg-green-50 border border-green-200 rounded-lg mb-2",children:(0,s.jsxs)("div",{className:"flex items-center gap-2 text-green-600 text-sm",children:[s.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),s.jsx("span",{className:"text-xs font-medium",children:"Auto Clock System Active"})]})}),(0,s.jsxs)("div",{className:"flex items-center justify-between py-3 border-t border-b border-gray-100 my-2 overflow-hidden",children:[s.jsx("div",{className:"text-gray-700 text-sm font-medium flex-shrink-0 pr-3",children:"Time In"}),(0,s.jsxs)("div",{className:"flex items-center gap-2 flex-1 justify-end min-w-0",children:[J?s.jsx("input",{type:"text",placeholder:"hh:mm AM/PM",className:"w-24 px-2 py-1 border border-gray-300 rounded-lg text-sm text-black placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:Z,onChange:e=>K(e.target.value),onKeyDown:e=>{"Enter"===e.key&&ei()},autoFocus:!0}):s.jsx("div",{className:"text-gray-900 text-sm font-medium text-right whitespace-nowrap",children:T||"--:--"}),s.jsx("button",{className:"bg-[#F0F0FF] text-blue-600 px-2 py-1 rounded-full text-xs font-medium hover:bg-blue-50 transition-colors whitespace-nowrap",onClick:()=>{J?ei():V(!0)},children:J?"Save":"Add"})]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between py-3 border-b border-gray-100 overflow-hidden",children:[s.jsx("div",{className:"text-gray-700 text-sm font-medium flex-shrink-0 pr-3",children:"Time Out"}),(0,s.jsxs)("div",{className:"flex items-center gap-2 flex-1 justify-end min-w-0",children:[z?s.jsx("input",{type:"text",placeholder:"hh:mm AM/PM",className:"w-24 px-2 py-1 border border-gray-300 rounded-lg text-sm text-black placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:$,onChange:e=>R(e.target.value),onKeyDown:e=>{"Enter"===e.key&&eo()},autoFocus:!0}):s.jsx("div",{className:"text-gray-900 text-sm font-medium text-right whitespace-nowrap",children:P||"--:--"}),s.jsx("button",{className:"bg-[#F0F0FF] text-blue-600 px-2 py-1 rounded-full text-xs font-medium hover:bg-blue-50 transition-colors whitespace-nowrap",onClick:()=>{z?eo():q(!0)},disabled:!T,children:z?"Save":"Add"})]})]}),(0,s.jsxs)("div",{className:"flex mt-2",children:[s.jsx("button",{className:"bg-[#F0F0FF] text-blue-600 w-1/2 ml-3 px-1 py-1 rounded-full mb-2 text-sm",onClick:()=>{L(),m(!0)},children:"Cash Up"}),s.jsx("button",{className:"bg-[#FFEDEB] text-red-600 w-1/2 ml-3 px-1 py-1 rounded-full mb-2 text-sm",onClick:el,children:"Logout"})]})]})})]})]}),h&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",style:{zIndex:2},children:(0,s.jsxs)("div",{style:{width:"400px"},className:"relative bg-white p-6 rounded-lg ",children:[s.jsx("div",{className:"absolute right-4 top-4",children:(0,s.jsxs)("svg",{onClick:()=>m(!1),width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[s.jsx("path",{d:"M18 6L6 18",stroke:"#2A2E34",strokeWidth:"2",strokeLinecap:"round"}),s.jsx("path",{d:"M6 6L18 18",stroke:"#2A2E34",strokeWidth:"2",strokeLinecap:"round"})]})}),s.jsx("h2",{className:"text-3xl flex justify-center font-semibold mb-4 text-gray-800",children:"Cash Up"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{htmlFor:"startingCash",className:"block text-sm font-medium text-gray-700 mb-2",children:["Starting Cash ",E.requireStartingCash&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{id:"startingCash",type:"number",name:"startingCash",placeholder:"Starting Cash",className:"w-full p-2 border rounded text-black placeholder-gray-400",value:C.startingCash,onChange:ec,required:E.requireStartingCash})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{htmlFor:"cashFromOrders",className:"block text-sm font-medium text-gray-700 mb-2",children:"Cash From Orders"}),s.jsx("input",{id:"cashFromOrders",type:"number",name:"cashFromOrders",placeholder:"Cash From Orders",className:"w-full p-2 border rounded text-black placeholder-gray-400",value:C.cashFromOrders,onChange:ec})]})]}),s.jsx("div",{className:"grid grid-cols-2 gap-4 mb-4",children:(0,s.jsxs)("div",{children:[s.jsx("label",{htmlFor:"declaredCash",className:"block text-sm font-medium text-gray-700 mb-2",children:"Declared Cash *"}),s.jsx("input",{id:"declaredCash",type:"number",name:"declaredCash",placeholder:"Declared Cash",className:"w-full p-2 border rounded text-black placeholder-gray-400",value:C.declaredCash,onChange:ec,required:!0})]})}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{htmlFor:"amount",className:"block text-sm font-medium text-gray-700 mb-2",children:"Amount *"}),s.jsx("input",{id:"amount",type:"number",name:"amount",placeholder:"Amount",className:"w-full p-2 border rounded text-black placeholder-gray-400",value:C.amount,onChange:ec,required:!0})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{htmlFor:"selectedUserId",className:"block text-sm font-medium text-gray-700 mb-2",children:"Select User *"}),(0,s.jsxs)("select",{id:"selectedUserId",name:"selectedUserId",className:"w-full p-2 border rounded bg-white text-black focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:C.selectedUserId,onChange:ec,required:!0,children:[s.jsx("option",{value:"",children:"Select User"}),F.map(e=>s.jsx("option",{value:e.id,children:e.name||e.email||`Staff ${e.id.slice(-4)}`},e.id))]})]})]}),(0,s.jsxs)("div",{className:"mb-4",children:[s.jsx("label",{htmlFor:"notes",className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes"}),s.jsx("textarea",{id:"notes",name:"notes",placeholder:"Notes",className:"w-full p-2 border rounded text-black placeholder-gray-400",rows:"3",value:C.notes,onChange:ec})]}),s.jsx("div",{className:"flex justify-center",children:s.jsx("button",{className:"bg-[#1D4FB6] text-white px-4 py-2 rounded disabled:bg-gray-400 disabled:cursor-not-allowed",onClick:ed,disabled:!C.amount||!C.selectedUserId||!C.declaredCash||E.requireStartingCash&&!C.startingCash,children:"Submit"})})]})}),x&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",style:{zIndex:2},children:(0,s.jsxs)("div",{className:"relative bg-white p-6 rounded-2xl shadow-lg mx-4",style:{width:"450px",height:"320px"},children:[s.jsx("button",{onClick:()=>f(!1),className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 text-2xl font-bold",children:"\xd7"}),s.jsx("div",{className:"absolute top-0 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-32 h-32 rounded-full bg-[#1D4FB6] flex items-center justify-center",children:(0,s.jsxs)("svg",{style:{transform:"scale(0.8)"},width:"78",height:"78",viewBox:"0 0 78 78",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[s.jsx("path",{d:"M65 68.25V61.75C65 58.9231 62.5766 56.25 59.5 56.25H19.5C16.4234 56.25 14 58.9231 14 61.75V68.25",stroke:"#F8F9FA",strokeWidth:"6.5",strokeLinecap:"round"}),s.jsx("path",{d:"M39 28.5C47.4927 28.5 55.5 20.4927 55.5 12C55.5 3.50736 47.4927 -4.5 39 -4.5C30.5074 -4.5 22.5 3.50736 22.5 12C22.5 20.4927 30.5074 28.5 39 28.5Z",stroke:"#F8F9FA",strokeWidth:"5.5",strokeLinecap:"round"})]})}),s.jsx("div",{className:"mt-10 text-center",children:s.jsx("h3",{className:"font-bold text-gray-700 text-2xl",children:"Switch User"})}),(0,s.jsxs)("div",{className:"mt-16 text-center px-6",children:[s.jsx("p",{className:"text-gray-600 text-lg mb-8 leading-relaxed",children:"Are you sure you want to switch users? This will automatically log you out and stop your current shift timer."}),(0,s.jsxs)("div",{className:"flex space-x-6",children:[s.jsx("button",{onClick:()=>f(!1),className:"flex-1 bg-gray-200 text-gray-700 font-semibold py-3 rounded-xl hover:bg-gray-300 transition-colors",children:"Cancel"}),s.jsx("button",{onClick:eu,className:"flex-1 bg-[#1D4FB6] text-white font-semibold py-3 rounded-xl hover:bg-indigo-700 transition-colors",children:"Switch User"})]})]})]})})]})}},89:(e,t,r)=>{r.d(t,{i:()=>s});let s={Collected:"collected",Pending:"pending",Completed:"completed",Ironing:"ironing",Ready:"ready"}},7481:(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var s=r(6621);let a=e=>[{type:"image/x-icon",sizes:"16x16",url:(0,s.fillMetadataSegment)(".",e.params,"favicon.ico")+""}]}};