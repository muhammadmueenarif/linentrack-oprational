(()=>{var e={};e.id=474,e.ids=[474],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},6113:e=>{"use strict";e.exports=require("crypto")},9523:e=>{"use strict";e.exports=require("dns")},2361:e=>{"use strict";e.exports=require("events")},358:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5158:e=>{"use strict";e.exports=require("http2")},1808:e=>{"use strict";e.exports=require("net")},2037:e=>{"use strict";e.exports=require("os")},1017:e=>{"use strict";e.exports=require("path")},7282:e=>{"use strict";e.exports=require("process")},2781:e=>{"use strict";e.exports=require("stream")},4404:e=>{"use strict";e.exports=require("tls")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},3290:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>l.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>c,routeModule:()=>u,tree:()=>o}),s(4983),s(7764),s(5866);var r=s(3191),a=s(8716),n=s(7922),l=s.n(n),i=s(5231),d={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>i[e]);s.d(t,d);let o=["",{children:["Admin",{children:["Cleaning",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,4983)),"/home/sidra/Desktop/linentrack_operations_app/app/Admin/Cleaning/page.js"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,7481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,7764)),"/home/sidra/Desktop/linentrack_operations_app/app/layout.js"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,7481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["/home/sidra/Desktop/linentrack_operations_app/app/Admin/Cleaning/page.js"],m="/Admin/Cleaning/page",x={require:s,loadChunk:()=>Promise.resolve()},u=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/Admin/Cleaning/page",pathname:"/Admin/Cleaning",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},9017:(e,t,s)=>{Promise.resolve().then(s.bind(s,7970))},7970:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>m});var r=s(326),a=s(7577),n=s(9318),l=s(8354),i=s(7147),d=s(76),o=s(89);let c=({setShowMessage:e})=>{let[t,s]=(0,a.useState)([]),[n,l]=(0,a.useState)(!0),[c,m]=(0,a.useState)("All"),[x,u]=(0,a.useState)("All"),[p,h]=(0,a.useState)(!1),[g,j]=(0,a.useState)(!1),[b,f]=(0,a.useState)(!1),[y,v]=(0,a.useState)(null),[N,w]=(0,a.useState)(""),[k,D]=(0,a.useState)(""),[C,A]=(0,a.useState)(null),[S,_]=(0,a.useState)(null),[q,L]=(0,a.useState)({highlightOrderRowRed:2}),[P,I]=(0,a.useState)([]),[M,O]=(0,a.useState)({orders:0,pieces:0,value:0,unpaid:0}),[E,R]=(0,a.useState)({notes:"",rackNumber:""});(0,a.useEffect)(()=>{let e=localStorage.getItem("userData");e&&A(JSON.parse(e).id);let t=localStorage.getItem("selectedStoreId");t&&_(t)},[]),(0,a.useEffect)(()=>{C&&S&&(z(),T())},[C,S]);let z=async()=>{try{let e=(0,d.JU)(i.db,"storeSettings",S),t=await getDoc(e);if(t.exists()){let e=t.data();L({highlightOrderRowRed:e.highlightOrderRowRed||2})}}catch(e){console.error("Error fetching store settings:",e)}};(0,a.useEffect)(()=>{if(!C||!S)return;let e=setInterval(()=>{T()},3e4);return()=>clearInterval(e)},[C,S]);let T=async()=>{try{l(!0);let e=(0,d.hJ)(i.db,"pos_orders",C,"stores",S,"orders"),t=(0,d.IO)(e,(0,d.ar)("status","==",o.i.Pending)),r=await (0,d.PL)(t),a=[];r.forEach(e=>{let t=e.data();a.push({id:e.id,...t,createdAt:t.createdAt?.toDate()||new Date,deliveryDate:t.deliveryDate?.toDate()||new Date})}),s(a)}catch(t){console.error("Error fetching orders:",t),e({type:"error",message:"Failed to fetch orders"})}finally{l(!1)}},B=e=>{let t=e.selectedItems||e.orders||e.items||[];return Array.isArray(t)?t.reduce((e,t)=>e+(Number(t?.quantity)||0),0):0},F=e=>{let t=e.section||e.category||e.serviceType||e.type;if(t)return t;let s=e.selectedItems||e.orders||e.items||[],r=Array.isArray(s)&&s.length>0?s[0]:null;return r?.section||r?.category||r?.type||"Unknown"},G=(e,t)=>{if("All"===t)return!0;let s=new Date;s.setHours(0,0,0,0);let r=new Date(s);r.setHours(23,59,59,999);let a=e.deliveryDate instanceof Date?e.deliveryDate:new Date(e.deliveryDate),n=e.createdAt instanceof Date?e.createdAt:new Date(e.createdAt),l=a>=s&&a<=r,i=(()=>{let e=new Date(s);e.setDate(e.getDate()+1);let t=new Date(r);return t.setDate(t.getDate()+1),a>=e&&a<=t})(),d=a<s;switch(t){case"Due Today":return l;case"Due Tomorrow":return i;case"Due Today & Overdue":return l||d;case"Overdue":return d;case"Created Today":return n>=s&&n<=r;default:return!0}},J=e=>!!e.deliveryDate&&Math.floor((new Date-new Date(e.deliveryDate))/864e5)>=parseInt(q.highlightOrderRowRed);(0,a.useEffect)(()=>{let e=k.toLowerCase(),s=t.filter(t=>{let s=t.customer?.name?.toLowerCase()||"",r=t.orderId?.toLowerCase()||"",a=!e||s.includes(e)||r.includes(e),n=F(t),l="All"===c||n===c,i=G(t,x);return a&&l&&i});I(s);let r=s.length;O({orders:r,pieces:s.reduce((e,t)=>e+B(t),0),value:s.reduce((e,t)=>e+(Number(t?.totalAmount)||Number(t?.total)||0),0),unpaid:s.reduce((e,t)=>{let s=Number(t?.totalAmount)||Number(t?.total)||0,r=Number(t?.paidAmount)||Number(t?.paid)||0,a=Number(t?.dueAmount);return e+(Number.isFinite(a)?a:Math.max(0,s-r))},0)})},[t,k,c,x]);let U=e=>{v(e),h(!0)},H=e=>{v(e),R({notes:e.notes||"",rackNumber:e.rackNumber||""}),f(!0)},V=e=>{v(e),j(!0)},W=async()=>{if(y&&N)try{let t=(0,d.JU)(i.db,"pos_orders",C,"stores",S,"orders",y.orderId);await (0,d.r7)(t,{status:o.i.Ironing,rackNumber:N,updatedAt:new Date,cleanedDateTime:new Date}),await T(),e({type:"success",message:"Order marked as cleaned successfully"}),h(!1),w(""),v(null)}catch(t){console.error("Error updating order:",t),e({type:"error",message:"Failed to update order"})}},$=async()=>{if(y)try{let t=(0,d.JU)(i.db,"pos_orders",C,"stores",S,"orders",y.orderId);await (0,d.r7)(t,{notes:E.notes,rackNumber:E.rackNumber,updatedAt:new Date}),await T(),e({type:"success",message:"Order updated successfully"}),f(!1),v(null)}catch(t){console.error("Error updating order:",t),e({type:"error",message:"Failed to update order"})}},K=async()=>{if(y)try{let t=(0,d.JU)(i.db,"pos_orders",C,"stores",S,"orders",y.orderId);await (0,d.oe)(t),await T(),e({type:"success",message:"Order deleted successfully"}),j(!1),v(null)}catch(t){console.error("Error deleting order:",t),e({type:"error",message:"Failed to delete order"})}},Q=e=>e?.map((e,t)=>r.jsxs("div",{className:"flex items-center mb-1",children:[r.jsx("span",{className:"w-3 h-3 rounded-full mr-2",style:{backgroundColor:e.color||"#000"}}),r.jsxs("span",{className:"text-sm",children:[e.name," \xd7 ",e.quantity]})]},t));return(0,r.jsxs)("div",{className:"flex-1 p-6 mt-20",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx("h1",{className:"text-2xl font-semibold mr-4",children:"Cleaning"}),r.jsx("div",{className:"hidden md:block w-px h-6 bg-gray-200 mx-2"}),(0,r.jsxs)("div",{className:"flex items-center gap-3 ml-4 md:ml-16 lg:ml-24",children:[(0,r.jsxs)("button",{className:"px-3 py-2 border rounded text-sm flex items-center gap-2 bg-white hover:bg-gray-50",onClick:()=>window.open("/Admin/Operational","_blank"),children:[r.jsx("span",{children:"Packing report"}),r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 9V2h12v7M6 18H5a2 2 0 01-2-2V9h18v7a2 2 0 01-2 2h-1M6 14h12v8H6v-8z"})})]}),(0,r.jsxs)("div",{className:"relative",children:[r.jsx("label",{className:"mr-2 text-sm text-gray-600",children:"Filter Section"}),(0,r.jsxs)("select",{value:c,onChange:e=>m(e.target.value),className:"px-3 py-2 border rounded bg-white text-sm",children:[r.jsx("option",{value:"All",children:"All"}),r.jsx("option",{value:"Dry Cleaning",children:"Dry Cleaning"}),r.jsx("option",{value:"Bulk Laundry",children:"Bulk Laundry"})]})]}),(0,r.jsxs)("select",{value:x,onChange:e=>u(e.target.value),className:"px-3 py-2 border rounded bg-white text-sm",children:[r.jsx("option",{children:"All"}),r.jsx("option",{children:"Due Today"}),r.jsx("option",{children:"Due Tomorrow"}),r.jsx("option",{children:"Due Today & Overdue"}),r.jsx("option",{children:"Overdue"}),r.jsx("option",{children:"Created Today"})]}),r.jsx("input",{type:"text",placeholder:"Search Order",value:k,onChange:e=>D(e.target.value),className:"px-3 py-2 border rounded text-sm w-48"})]})]}),(0,r.jsxs)("div",{className:"hidden md:flex items-center gap-6 text-xs text-gray-700",children:[(0,r.jsxs)("div",{children:[r.jsx("span",{className:"mr-1",children:"Orders"}),r.jsx("span",{className:"font-medium",children:M.orders})]}),(0,r.jsxs)("div",{children:[r.jsx("span",{className:"mr-1",children:"Pieces"}),r.jsx("span",{className:"font-medium",children:M.pieces})]}),(0,r.jsxs)("div",{children:[r.jsx("span",{className:"mr-1",children:"Value"}),(0,r.jsxs)("span",{className:"font-medium",children:["PKR ",M.value.toLocaleString()]})]}),(0,r.jsxs)("div",{children:[r.jsx("span",{className:"mr-1",children:"Unpaid"}),(0,r.jsxs)("span",{className:"font-medium",children:["PKR ",M.unpaid.toLocaleString()]})]})]})]}),r.jsx("div",{className:"bg-white rounded-lg overflow-hidden",children:(0,r.jsxs)("table",{className:"w-full whitespace-nowrap",children:[r.jsx("thead",{children:(0,r.jsxs)("tr",{className:"border-b",children:[r.jsx("th",{className:"p-3 text-left text-xs font-medium text-gray-700",children:"Admin ID"}),r.jsx("th",{className:"p-3 text-left text-xs font-medium text-gray-700",children:"Placed"}),r.jsx("th",{className:"p-3 text-left text-xs font-medium text-gray-700",children:"Customer"}),r.jsx("th",{className:"p-3 text-left text-xs font-medium text-gray-700",children:"ORDER"}),r.jsx("th",{className:"p-3 text-left text-xs font-medium text-gray-700",children:"Qty"}),r.jsx("th",{className:"p-3 text-left text-xs font-medium text-gray-700",children:"Notes"}),r.jsx("th",{className:"p-3 text-left text-xs font-medium text-gray-700",children:"Rack #"}),r.jsx("th",{className:"p-3 text-right text-xs font-medium text-gray-700",children:"Actions"})]})}),(0,r.jsxs)("tbody",{className:"divide-y divide-gray-100",children:[P.map(e=>(0,r.jsxs)("tr",{className:`hover:bg-gray-50 ${J(e)?"bg-red-50":""}`,children:[r.jsx("td",{className:"p-3 text-sm",children:e.adminId||"-"}),r.jsx("td",{className:"p-3 text-sm",children:e.createdAt.toLocaleDateString()}),r.jsx("td",{className:"p-3 text-sm",children:e.customer?.name||"-"}),r.jsx("td",{className:"p-3 text-sm",children:r.jsx("div",{className:"max-w-xs",children:Q(e.selectedItems||e.orders||e.items)})}),r.jsx("td",{className:"p-3 text-sm",children:B(e)}),r.jsx("td",{className:"p-3 text-sm",children:e.notes||"-"}),r.jsx("td",{className:"p-3 text-sm",children:e.rackNumber||"-"}),r.jsx("td",{className:"p-3 text-right",children:(0,r.jsxs)("div",{className:"flex justify-end items-center gap-4",children:[r.jsx("button",{onClick:()=>V(e),className:"text-red-500 hover:text-red-600",title:"Delete",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),r.jsx("button",{onClick:()=>H(e),className:"text-indigo-600 hover:text-indigo-700",title:"Edit",children:(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16.862 3.487a2.1 2.1 0 012.971 2.971L9.75 16.54 6 17.5l.96-3.75L16.862 3.487z"}),r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 21h9"})]})}),r.jsx("button",{onClick:()=>U(e),className:"px-4 py-2 bg-indigo-50 text-indigo-700 rounded-full text-sm hover:bg-indigo-100",children:r.jsx("span",{className:"whitespace-nowrap",children:"Mark as Cleaned"})})]})})]},e.orderId)),n&&r.jsx("tr",{children:r.jsx("td",{className:"p-3 text-sm",colSpan:"8",children:"Loading orders..."})})]})]})}),p&&y&&r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,r.jsxs)("div",{className:"relative bg-white p-6 rounded-xl w-[380px] shadow-xl",children:[r.jsx("button",{onClick:()=>{h(!1),v(null)},className:"absolute right-4 top-4 text-gray-500 hover:text-gray-700","aria-label":"Close",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),r.jsx("h2",{className:"mb-6 text-2xl font-semibold text-center",children:"Mark as Cleaned"}),(0,r.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[r.jsx("label",{className:"text-base font-medium",children:"Order#"}),(0,r.jsxs)("div",{className:"text-gray-600",children:["#",y.orderId||""]})]}),(0,r.jsxs)("div",{className:"mb-6 flex items-center justify-between",children:[r.jsx("label",{className:"text-base font-medium mr-4",children:"Rack #"}),r.jsx("input",{type:"text",value:N,onChange:e=>w(e.target.value),placeholder:"#",className:"px-3 py-2 border border-indigo-300 rounded-md text-sm w-40 focus:outline-none focus:ring-2 focus:ring-indigo-200"})]}),r.jsx("div",{className:"flex justify-center",children:r.jsx("button",{onClick:W,className:"px-4 py-2 bg-blue-600 text-white rounded-md text-sm hover:bg-blue-700",children:"Move to Ironing"})})]})}),b&&y&&r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg w-96",children:[r.jsx("h2",{className:"mb-4 text-lg font-semibold",children:"Edit Order"}),(0,r.jsxs)("div",{className:"mb-4",children:[r.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Order #"}),r.jsx("input",{type:"text",value:y.orderId||"",disabled:!0,className:"w-full px-3 py-2 border rounded bg-gray-50 text-sm"})]}),(0,r.jsxs)("div",{className:"mb-4",children:[r.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Notes"}),r.jsx("textarea",{value:E.notes,onChange:e=>R({...E,notes:e.target.value}),className:"w-full px-3 py-2 border rounded text-sm",rows:"3"})]}),(0,r.jsxs)("div",{className:"mb-6",children:[r.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Rack #"}),r.jsx("input",{type:"text",value:E.rackNumber,onChange:e=>R({...E,rackNumber:e.target.value}),className:"w-full px-3 py-2 border rounded text-sm"})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-3",children:[r.jsx("button",{onClick:()=>{f(!1),v(null)},className:"px-4 py-2 border rounded text-sm",children:"Cancel"}),r.jsx("button",{onClick:$,className:"px-4 py-2 bg-blue-600 text-white rounded text-sm",children:"Save Changes"})]})]})}),g&&y&&r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg w-96",children:[r.jsx("h2",{className:"mb-4 text-lg font-semibold",children:"Delete Order"}),r.jsx("p",{className:"mb-6 text-sm",children:"Are you sure you want to delete this order? This action cannot be undone."}),(0,r.jsxs)("div",{className:"flex justify-end gap-3",children:[r.jsx("button",{onClick:()=>{j(!1),v(null)},className:"px-4 py-2 border rounded text-sm",children:"Cancel"}),r.jsx("button",{onClick:K,className:"px-4 py-2 bg-red-600 text-white rounded text-sm",children:"Delete"})]})]})})]})};function m(){let[e,t]=(0,a.useState)({type:null,message:null});return(0,r.jsxs)(r.Fragment,{children:[e.message&&("success"===e.type?r.jsx(l.kk,{message:e.message}):r.jsx(l.Bc,{message:e.message})),(0,r.jsxs)("div",{className:"min-h-screen",children:[r.jsx(n.Z,{}),r.jsx(c,{setShowMessage:t})]})]})}},8354:(e,t,s)=>{"use strict";s.d(t,{Bc:()=>n,kk:()=>a});var r=s(326);s(7577);let a=({message:e})=>(0,r.jsxs)("div",{style:{zIndex:"999"},className:"fixed top-16 left-1/2 transform -translate-x-1/2 -translate-y-1/2  bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded flex items-center",role:"alert",children:[r.jsx("svg",{className:"fill-current h-6 w-6 text-green-500 mr-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:r.jsx("path",{d:"M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zm12.73-1.41A8 8 0 1 0 4.34 4.34a8 8 0 0 0 11.32 11.32zM6.7 9.29L9 11.6l4.3-4.3 1.4 1.42L9 14.4l-3.7-3.7 1.4-1.42z"})}),r.jsx("span",{className:"block sm:inline",children:e})]}),n=({message:e})=>(0,r.jsxs)("div",{style:{zIndex:"999"},className:"fixed top-16 left-1/2 transform -translate-x-1/2 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded flex items-center",role:"alert",children:[r.jsx("svg",{className:"fill-current h-6 w-6 text-red-500 mr-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:r.jsx("path",{d:"M18 10a8 8 0 1 1-16 0 8 8 0 0 1 16 0zm-7 4a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm-1-9a1 1 0 0 0-1 1v4a1 1 0 1 0 2 0V6a1 1 0 0 0-1-1z"})}),r.jsx("span",{className:"block sm:inline",children:e})]})},4983:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>l,__esModule:()=>n,default:()=>i});var r=s(8570);let a=(0,r.createProxy)(String.raw`/home/sidra/Desktop/linentrack_operations_app/app/Admin/Cleaning/page.js`),{__esModule:n,$$typeof:l}=a;a.default;let i=(0,r.createProxy)(String.raw`/home/sidra/Desktop/linentrack_operations_app/app/Admin/Cleaning/page.js#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[948,1,621,945,706,610],()=>s(3290));module.exports=r})();